/*! For license information please see cgsd.js.LICENSE.txt */
(()=>{var e,t={576:()=>{},757:()=>{function e(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function i(e,o,a,c){var i=o&&o.prototype instanceof l?o:l,u=Object.create(i.prototype);return t(u,"_invoke",function(e,t,o){var a,c,i,l=0,u=o||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return a=e,c=0,i=n,f.n=t,s}};function p(e,t){for(c=e,i=t,r=0;!d&&l&&!o&&r<u.length;r++){var o,a=u[r],p=f.p,v=a[2];e>3?(o=v===t)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=p&&((o=e<2&&p<a[1])?(c=0,f.v=t,f.n=a[1]):p<v&&(o=e<3||a[0]>t||t>v)&&(a[4]=e,a[5]=t,f.n=v,c=0))}if(o||e>1)return s;throw d=!0,t}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,i=v;(r=c<2?n:i)||!d;){a||(c?c<3?(c>1&&(f.n=-1),p(c,i)):f.n=i:f.v=i);try{if(l=2,a){if(c||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((r=(d=f.n<0)?i:e.call(t,f))!==s)break}catch(e){a=n,c=1,i=e}finally{l=1}}return{value:r,done:d}}}(e,a,c),!0),u}var s={};function l(){}function u(){}function d(){}r=Object.getPrototypeOf;var f=[][a]?r(r([][a]())):(t(r={},a,function(){return this}),r),p=d.prototype=l.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,t(p,"constructor",d),t(d,"constructor",u),u.displayName="GeneratorFunction",t(d,c,"GeneratorFunction"),t(p),t(p,c,"Generator"),t(p,a,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:v}})()}function t(e,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}t=function(e,n,r,o){function c(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?a?a(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(c("next",0),c("throw",1),c("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,a){var c=e.apply(t,r);function i(e){n(c,o,a,i,s,"next",e)}function s(e){n(c,o,a,i,s,"throw",e)}i(void 0)})}}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var a;a=window.addEventListener,window.addEventListener=function(e,t,n){"scroll"===e&&("boolean"==typeof n?n={passive:!0}:"object"===o(n)&&(n.passive=!0)),a.call(this,e,t,n)},document.addEventListener("DOMContentLoaded",r(e().m(function t(){var n,r,o,a,c,i,s,l,u,d,f,p,v,g,h,b,m,y;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=document.getElementById("cgsd-sheet-container")){e.n=1;break}return e.a(2);case 1:if(r=JSON.parse(n.dataset.attrs||"{}"),o=r.sheet_id,a=r.api_key,c=r.range,o&&a){e.n=2;break}return n.innerHTML='<p class="text-red-600">Missing Sheet ID or API Key</p>',e.a(2);case 2:if(i="https://sheets.googleapis.com/v4/spreadsheets/".concat(o,"/values/").concat(c,"?key=").concat(a),s="cgsd_sheet_cache",l=Date.now(),n.innerHTML='\n    <div class="animate-pulse text-center text-gray-500 py-6">\n      Loading data from Google Sheets...\n    </div>\n  ',e.p=3,u=localStorage.getItem(s),d=localStorage.getItem(s+"_time"),!(u&&d&&l-d<6e5)){e.n=4;break}f=JSON.parse(u),console.log("Using cached Google Sheet data ✅"),e.n=7;break;case 4:return e.n=5,fetch(i,{cache:"no-cache"});case 5:return p=e.v,e.n=6,p.json();case 6:f=e.v,localStorage.setItem(s,JSON.stringify(f)),localStorage.setItem(s+"_time",l),console.log("Fetched fresh data from Google Sheet 🌐");case 7:if(f.values&&!(f.values.length<2)){e.n=8;break}return n.innerHTML='<p class="text-yellow-700">No data found</p>',e.a(2);case 8:v=f.values[0],g=f.values.slice(1),h=/^(https?:\/\/)?([\w.-]+)\.([a-zA-Z]{2,})([\w\/\.\-\?\=\&\#\%]*)?$/,b=document.createDocumentFragment(),(m=document.createElement("div")).className="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-2 gap-6",g.forEach(function(e){var t={};v.forEach(function(n,r){return t[n]=e[r]||""});var n=document.createElement("article");n.className="group relative rounded-2xl ring-1 ring-gray-200 bg-white hover:shadow-xl transition-shadow",n.innerHTML='\n        <div class="font-bold text-lg text-center bg-[#0B284D] text-[#FED312] py-1 rounded-t-xl">\n          '.concat(t["Agency Name"]||"—",'\n        </div>\n        <div class="p-4">\n          <div class="mt-2 text-sm text-gray-700"><strong>Website:</strong> ').concat(t.Website||"",'</div>\n          <div class="text-sm text-gray-700"><strong>Facebook:</strong> ').concat(t["Facebook Page"]||"",'</div>\n          <div class="text-sm text-gray-700"><strong>Phone:</strong> ').concat(t["Phone Number"]||"","</div>\n        </div>\n      ");var r=document.createElement("div");if(r.className="flex items-center justify-center pb-2 gap-3",t.Website&&h.test(t.Website)){var o=document.createElement("a");o.href=t.Website,o.target="_blank",o.rel="noopener",o.className="inline-flex font-bold items-center rounded-xl border px-6 py-1.5 text-sm hover:bg-[#0B284D]/90 hover:text-[#FED312] bg-[#0B284D] text-[#FED312]",o.textContent="View",r.appendChild(o)}if(t["Facebook Page"]&&h.test(t["Facebook Page"])){var a=document.createElement("a");a.href=t["Facebook Page"],a.target="_blank",a.rel="noopener",a.className="inline-flex font-bold items-center rounded-xl border px-6 py-1.5 text-sm hover:bg-gray-50",a.textContent="Facebook",r.appendChild(a)}n.appendChild(r),m.appendChild(n)}),b.appendChild(m),n.innerHTML="",n.appendChild(b),e.n=10;break;case 9:e.p=9,y=e.v,n.innerHTML='<p class="text-red-600">Error fetching data: '.concat(y.message,"</p>"),console.error("Google Sheet Fetch Error ❌",y);case 10:return e.a(2)}},t,null,[[3,9]])})))}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,n,o,a)=>{if(!n){var c=1/0;for(u=0;u<e.length;u++){for(var[n,o,a]=e[u],i=!0,s=0;s<n.length;s++)(!1&a||c>=a)&&Object.keys(r.O).every(e=>r.O[e](n[s]))?n.splice(s--,1):(i=!1,a<c&&(c=a));if(i){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={685:0,252:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[c,i,s]=n,l=0;if(c.some(t=>0!==e[t])){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(s)var u=s(r)}for(t&&t(n);l<c.length;l++)a=c[l],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(u)},n=self.webpackChunkcotactic_get_data_sheet=self.webpackChunkcotactic_get_data_sheet||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.O(void 0,[252],()=>r(757));var o=r.O(void 0,[252],()=>r(576));o=r.O(o)})();